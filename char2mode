#!/bin/bash

set -Ce

# Keys   : Ascii table range 32..126 and new line 10.
# Values : Octal access mode.

declare -A char2mode=(
[' ']='200' ['!']='204' ['"']='210' ['#']='214' ['$']='220'
['%']='224' ['&']='230' ["'"]='234' ['(']='240' [')']='244'
['*']='250' ['+']='254' [',']='260' ['-']='264' ['.']='270'
['0']='300' ['1']='304' ['2']='310' ['3']='314' ['4']='320'
['5']='324' ['6']='330' ['7']='334' ['8']='340' ['9']='344'
[':']='350' [';']='354' ['<']='360' ['=']='364' ['>']='370'
['?']='374' ['@']='400' ['A']='404' ['B']='410' ['C']='414'
['D']='420' ['E']='424' ['F']='430' ['G']='434' ['H']='440'
['I']='444' ['J']='450' ['K']='454' ['L']='460' ['M']='464'
['N']='470' ['O']='474' ['P']='500' ['Q']='504' ['R']='510'
['S']='514' ['T']='520' ['U']='524' ['V']='530' ['W']='534'
['X']='540' ['Y']='544' ['Z']='550' ['[']='554' ['\']='560'
[']']='564' ['^']='570' ['_']='574' ['`']='600' ['a']='604'
['b']='610' ['c']='614' ['d']='620' ['e']='624' ['f']='630'
['g']='634' ['h']='640' ['i']='644' ['j']='650' ['k']='654'
['l']='660' ['m']='664' ['n']='670' ['o']='674' ['p']='700'
['q']='704' ['r']='710' ['s']='714' ['t']='720' ['u']='724'
['v']='730' ['w']='734' ['x']='740' ['y']='744' ['z']='750'
['{']='754' ['|']='760' ['}']='764' ['~']='770' ['/']='274' [$'\n']='050' )

workdir="$1"
string="$2"
length=${#string}
length=${#length}
 
Oops...() {
echo 'Oops...' 
echo "Line:$1"
exit
}

cd -P "$workdir" 
[[ "$string" ]] || Oops... "$LINENO"

for((i=0;i<${#string};++i)) {
    char="${string:i:1}"
    mode="${char2mode["$char"]}"
    
    # It's not profitable to check every character. 
    # Use regex before the loop. 
    [[ "$mode" ]] || Oops... "$LINENO"
    
    # Specific names. For decoding. Bash uses lexicographic sort order.
    # See man bash subsection 'Pathname Expansion' section 'EXPANSION'.
    printf -v filename '%0*d' "$length" "$i"
    
    : > "$filename"
    chmod "$mode" "$filename"
}
